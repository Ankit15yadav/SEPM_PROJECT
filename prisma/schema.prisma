// prisma/schema.prisma

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model Post {
    id        Int      @id @default(autoincrement())
    name      String
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    @@index([name])
}

model User {
    id           String   @id @default(uuid())
    createdAt    DateTime @default(now())
    updatedAt    DateTime @updatedAt
    imageUrl     String?
    firstName    String?
    lastName     String?
    emailAddress String   @unique
    maxGroups    Int      @default(0)
    interests    String[]

    groupMembers GroupMember[]

    createdGroups Group[] @relation("GroupCreator")
}

model Group {
    id        String   @id @default(uuid())
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    name        String
    description String
    imageUrl    String?
    maxMembers  Int
    isPublic    Boolean
    category    String

    tags GroupTag[]

    members GroupMember[]

    createdBy User   @relation("GroupCreator", fields: [userId], references: [id])
    userId    String
}

model GroupTag {
    id      String @id @default(uuid())
    name    String
    group   Group  @relation(fields: [groupId], references: [id])
    groupId String

    @@unique([name, groupId])
}

model GroupMember {
    id      String @id @default(uuid())
    role    String
    group   Group  @relation(fields: [groupId], references: [id])
    groupId String
    user    User   @relation(fields: [userId], references: [id])
    userId  String

    @@unique([groupId, userId])
}
